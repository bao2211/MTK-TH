{
	"info": {
		"_postman_id": "factory-method-pattern-demo",
		"name": "Factory Method Pattern - Payment API Demo",
		"description": "Collection ƒë·ªÉ test Factory Method Pattern v·ªõi Payment API.\nDemo c√°ch Factory t·∫°o c√°c payment methods kh√°c nhau (Cash, PayPal, VNPay).",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "1. Get Payment Methods",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"Response has payment methods\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData.success).to.be.true;",
							"    pm.expect(jsonData.data).to.be.an('array');",
							"    pm.expect(jsonData.data.length).to.equal(3);",
							"    ",
							"    console.log(\"\\nüìã ========================================\");",
							"    console.log(\"üí≥ PAYMENT METHODS AVAILABLE:\");",
							"    jsonData.data.forEach(function(method) {",
							"        console.log(`\\n  ‚úÖ ${method.displayName} (${method.type})`);",
							"        console.log(`     ${method.description}`);",
							"        console.log(`     Fee: ${method.feeDescription}`);",
							"        console.log(`     Required: ${method.requiredFields.join(', ')}`);",
							"    });",
							"    console.log(\"\\n========================================\\n\");",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/payment/methods",
					"host": ["{{baseUrl}}"],
					"path": ["api", "payment", "methods"]
				},
				"description": "L·∫•y danh s√°ch c√°c payment methods ƒë∆∞·ª£c h·ªó tr·ª£"
			},
			"response": []
		},
		{
			"name": "2. Process Cash Payment",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"üéØ Factory created CashPayment\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData.success).to.be.true;",
							"    pm.expect(jsonData.data.paymentType).to.equal('CASH');",
							"    pm.expect(jsonData.data.transactionFee).to.equal(0);",
							"    ",
							"    console.log(\"\\nüíµ ========================================\");",
							"    console.log(\"‚úÖ CASH PAYMENT SUCCESSFUL\");",
							"    console.log(`   Transaction ID: ${jsonData.data.transactionId}`);",
							"    console.log(`   Amount: ${jsonData.data.amount.toLocaleString()} VNƒê`);",
							"    console.log(`   Fee: ${jsonData.data.transactionFee} VNƒê (FREE)`);",
							"    console.log(`   Total: ${jsonData.data.totalAmount.toLocaleString()} VNƒê`);",
							"    console.log(\"\\nüéØ Factory Method created: CashPayment class\");",
							"    console.log(\"========================================\\n\");",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"paymentType\": \"CASH\",\n  \"amount\": 500000,\n  \"orderId\": \"ORD-CASH-001\",\n  \"additionalData\": {\n    \"ReceivedAmount\": \"500000\",\n    \"ChangeAmount\": \"0\",\n    \"Cashier\": \"John Doe\"\n  }\n}"
				},
				"url": {
					"raw": "{{baseUrl}}/api/payment/process",
					"host": ["{{baseUrl}}"],
					"path": ["api", "payment", "process"]
				},
				"description": "Factory t·∫°o CashPayment object - Kh√¥ng c√≥ ph√≠ giao d·ªãch"
			},
			"response": []
		},
		{
			"name": "3. Process PayPal Payment",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"üéØ Factory created PaypalPayment\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData.success).to.be.true;",
							"    pm.expect(jsonData.data.paymentType).to.equal('PAYPAL');",
							"    pm.expect(jsonData.data.transactionFee).to.be.above(0);",
							"    ",
							"    var feePercent = (jsonData.data.transactionFee / jsonData.data.amount * 100).toFixed(2);",
							"    ",
							"    console.log(\"\\nüí≥ ========================================\");",
							"    console.log(\"‚úÖ PAYPAL PAYMENT SUCCESSFUL\");",
							"    console.log(`   Transaction ID: ${jsonData.data.transactionId}`);",
							"    console.log(`   Amount: $${jsonData.data.amount}`);",
							"    console.log(`   Fee: $${jsonData.data.transactionFee.toFixed(2)} (${feePercent}%)`);",
							"    console.log(`   Total: $${jsonData.data.totalAmount.toFixed(2)}`);",
							"    console.log(`   PayPal Email: ${jsonData.data.additionalInfo.PaypalEmail}`);",
							"    console.log(\"\\nüéØ Factory Method created: PaypalPayment class\");",
							"    console.log(\"========================================\\n\");",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"paymentType\": \"PAYPAL\",\n  \"amount\": 100,\n  \"orderId\": \"ORD-PAYPAL-002\",\n  \"additionalData\": {\n    \"PaypalEmail\": \"customer@example.com\"\n  }\n}"
				},
				"url": {
					"raw": "{{baseUrl}}/api/payment/process",
					"host": ["{{baseUrl}}"],
					"path": ["api", "payment", "process"]
				},
				"description": "Factory t·∫°o PaypalPayment object - Ph√≠ 3.4% + $0.30"
			},
			"response": []
		},
		{
			"name": "4. Process VNPay Payment",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"üéØ Factory created VNPayPayment\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData.success).to.be.true;",
							"    pm.expect(jsonData.data.paymentType).to.equal('VNPAY');",
							"    pm.expect(jsonData.data.transactionFee).to.be.above(0);",
							"    ",
							"    var feePercent = (jsonData.data.transactionFee / jsonData.data.amount * 100).toFixed(2);",
							"    ",
							"    console.log(\"\\nüè¶ ========================================\");",
							"    console.log(\"‚úÖ VNPAY PAYMENT SUCCESSFUL\");",
							"    console.log(`   Transaction ID: ${jsonData.data.transactionId}`);",
							"    console.log(`   Amount: ${jsonData.data.amount.toLocaleString()} VNƒê`);",
							"    console.log(`   Fee: ${jsonData.data.transactionFee.toLocaleString()} VNƒê (${feePercent}%)`);",
							"    console.log(`   Total: ${jsonData.data.totalAmount.toLocaleString()} VNƒê`);",
							"    console.log(`   Bank: ${jsonData.data.additionalInfo.BankCode}`);",
							"    console.log(\"\\nüéØ Factory Method created: VNPayPayment class\");",
							"    console.log(\"========================================\\n\");",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"paymentType\": \"VNPAY\",\n  \"amount\": 1000000,\n  \"orderId\": \"ORD-VNPAY-003\",\n  \"additionalData\": {\n    \"BankCode\": \"NCB\",\n    \"CardNumber\": \"9704123456789012\"\n  }\n}"
				},
				"url": {
					"raw": "{{baseUrl}}/api/payment/process",
					"host": ["{{baseUrl}}"],
					"path": ["api", "payment", "process"]
				},
				"description": "Factory t·∫°o VNPayPayment object - Ph√≠ 2% (max 50k VNƒê)"
			},
			"response": []
		},
		{
			"name": "5. Calculate Fee - Cash",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"Cash has no fee\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData.data.transactionFee).to.equal(0);",
							"    console.log(\"üíµ CASH: No transaction fee\");",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/payment/calculate-fee?paymentType=CASH&amount=1000000",
					"host": ["{{baseUrl}}"],
					"path": ["api", "payment", "calculate-fee"],
					"query": [
						{
							"key": "paymentType",
							"value": "CASH"
						},
						{
							"key": "amount",
							"value": "1000000"
						}
					]
				},
				"description": "T√≠nh ph√≠ cho thanh to√°n ti·ªÅn m·∫∑t"
			},
			"response": []
		},
		{
			"name": "6. Calculate Fee - PayPal",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"PayPal fee calculation\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData.data.transactionFee).to.be.above(0);",
							"    console.log(`üí≥ PAYPAL Fee: $${jsonData.data.transactionFee.toFixed(2)} (${jsonData.data.feePercentage.toFixed(2)}%)`);",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/payment/calculate-fee?paymentType=PAYPAL&amount=100",
					"host": ["{{baseUrl}}"],
					"path": ["api", "payment", "calculate-fee"],
					"query": [
						{
							"key": "paymentType",
							"value": "PAYPAL"
						},
						{
							"key": "amount",
							"value": "100"
						}
					]
				},
				"description": "T√≠nh ph√≠ cho thanh to√°n PayPal"
			},
			"response": []
		},
		{
			"name": "7. Calculate Fee - VNPay",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"VNPay fee calculation\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData.data.transactionFee).to.be.above(0);",
							"    pm.expect(jsonData.data.transactionFee).to.be.at.most(50000);",
							"    console.log(`üè¶ VNPAY Fee: ${jsonData.data.transactionFee.toLocaleString()} VNƒê (${jsonData.data.feePercentage.toFixed(2)}%)`);",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/payment/calculate-fee?paymentType=VNPAY&amount=1000000",
					"host": ["{{baseUrl}}"],
					"path": ["api", "payment", "calculate-fee"],
					"query": [
						{
							"key": "paymentType",
							"value": "VNPAY"
						},
						{
							"key": "amount",
							"value": "1000000"
						}
					]
				},
				"description": "T√≠nh ph√≠ cho thanh to√°n VNPay"
			},
			"response": []
		},
		{
			"name": "8. Demo Factory Pattern",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"üéØ Factory Method Pattern Demo\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData.success).to.be.true;",
							"    pm.expect(jsonData.data.paymentMethods).to.be.an('array');",
							"    pm.expect(jsonData.data.paymentMethods.length).to.equal(3);",
							"    ",
							"    console.log(\"\\nüè≠ ========================================\");",
							"    console.log(\"üéØ FACTORY METHOD PATTERN DEMO\");",
							"    console.log(`\\nFactory Type: ${jsonData.data.factoryType}`);",
							"    console.log(\"\\nüì¶ Products created by Factory:\");",
							"    ",
							"    jsonData.data.paymentMethods.forEach(function(method) {",
							"        console.log(`\\n  ‚úÖ ${method.paymentType}`);",
							"        console.log(`     Class: ${method.className}`);",
							"        console.log(`     Instance HashCode: ${method.hashCode}`);",
							"        console.log(`     Sample Fee (1M): ${method.sampleFee.toLocaleString()}`);",
							"    });",
							"    ",
							"    console.log(\"\\nüí° Note:\");",
							"    console.log(\"   - Each call creates a NEW instance\");",
							"    console.log(\"   - Factory decides which class to instantiate\");",
							"    console.log(\"   - Client doesn't need to know concrete classes\");",
							"    console.log(\"========================================\\n\");",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/payment/demo-factory",
					"host": ["{{baseUrl}}"],
					"path": ["api", "payment", "demo-factory"]
				},
				"description": "Demo Factory Method Pattern - Xem c√°ch Factory t·∫°o c√°c payment methods kh√°c nhau"
			},
			"response": []
		},
		{
			"name": "9. Unsupported Payment Method",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 400\", function () {",
							"    pm.response.to.have.status(400);",
							"});",
							"",
							"pm.test(\"Factory rejects unsupported payment\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData.success).to.be.false;",
							"    pm.expect(jsonData.message).to.include('kh√¥ng ƒë∆∞·ª£c h·ªó tr·ª£');",
							"    ",
							"    console.log(\"\\n‚ùå ========================================\");",
							"    console.log(\"‚ùå UNSUPPORTED PAYMENT METHOD\");",
							"    console.log(`   Error: ${jsonData.message}`);",
							"    console.log(`   Supported: ${jsonData.data.supportedMethods.join(', ')}`);",
							"    console.log(\"========================================\\n\");",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"paymentType\": \"BITCOIN\",\n  \"amount\": 1000000,\n  \"orderId\": \"ORD-FAIL-001\"\n}"
				},
				"url": {
					"raw": "{{baseUrl}}/api/payment/process",
					"host": ["{{baseUrl}}"],
					"path": ["api", "payment", "process"]
				},
				"description": "Test v·ªõi payment method kh√¥ng ƒë∆∞·ª£c h·ªó tr·ª£ - Factory s·∫Ω throw exception"
			},
			"response": []
		},
		{
			"name": "10. VNPay with Invalid Bank Code",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 400\", function () {",
							"    pm.response.to.have.status(400);",
							"});",
							"",
							"pm.test(\"Validation failed\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData.success).to.be.false;",
							"    console.log(\"‚ùå Validation Error:\", jsonData.message);",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"paymentType\": \"VNPAY\",\n  \"amount\": 1000000,\n  \"orderId\": \"ORD-FAIL-002\",\n  \"additionalData\": {\n    \"BankCode\": \"INVALID_BANK\"\n  }\n}"
				},
				"url": {
					"raw": "{{baseUrl}}/api/payment/process",
					"host": ["{{baseUrl}}"],
					"path": ["api", "payment", "process"]
				},
				"description": "Test validation - VNPay v·ªõi m√£ ng√¢n h√†ng kh√¥ng h·ª£p l·ªá"
			},
			"response": []
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:5000",
			"type": "string"
		}
	]
}
