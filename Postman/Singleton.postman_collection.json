{
	"info": {
		"_postman_id": "singleton-pattern-demo",
		"name": "Singleton Pattern - Logger Service Demo",
		"description": "Collection ƒë·ªÉ test v√† demo Singleton Pattern v·ªõi Logger Service.\nCh·∫°y theo th·ª© t·ª± ƒë·ªÉ th·∫•y logs t√≠ch l≈©y t·ª´ nhi·ªÅu Controllers kh√°c nhau v√†o c√πng m·ªôt Singleton instance.",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "1. Health Check",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"Response has LoggerInstanceId\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData).to.have.property('loggerInstanceId');",
							"    ",
							"    // L∆∞u Instance ID ƒë·ªÉ so s√°nh v·ªõi c√°c request kh√°c",
							"    pm.environment.set(\"loggerInstanceId\", jsonData.loggerInstanceId);",
							"    console.log(\"‚úÖ Logger Instance ID:\", jsonData.loggerInstanceId);",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/health",
					"host": ["{{baseUrl}}"],
					"path": ["health"]
				},
				"description": "Ki·ªÉm tra API ƒëang ch·∫°y v√† l·∫•y Logger Instance ID ƒë·∫ßu ti√™n"
			},
			"response": []
		},
		{
			"name": "2. Get All Users (UserController)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"UserController uses SAME Singleton Instance\", function () {",
							"    var jsonData = pm.response.json();",
							"    var savedInstanceId = pm.environment.get(\"loggerInstanceId\");",
							"    ",
							"    pm.expect(jsonData.loggerInstanceId).to.eql(savedInstanceId);",
							"    console.log(\"‚úÖ UserController Instance ID:\", jsonData.loggerInstanceId);",
							"    console.log(\"‚úÖ MATCH with saved ID:\", savedInstanceId);",
							"});",
							"",
							"pm.test(\"Response has user data\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData.success).to.be.true;",
							"    pm.expect(jsonData.data).to.be.an('array');",
							"    pm.expect(jsonData.data.length).to.be.at.least(1);",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/user",
					"host": ["{{baseUrl}}"],
					"path": ["api", "user"]
				},
				"description": "L·∫•y danh s√°ch users - Logs s·∫Ω ƒë∆∞·ª£c ghi b·ªüi UserController"
			},
			"response": []
		},
		{
			"name": "3. Get User By ID (UserController)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"UserController still uses SAME Instance\", function () {",
							"    var jsonData = pm.response.json();",
							"    var savedInstanceId = pm.environment.get(\"loggerInstanceId\");",
							"    ",
							"    pm.expect(jsonData.loggerInstanceId).to.eql(savedInstanceId);",
							"    console.log(\"‚úÖ Still same Instance ID:\", jsonData.loggerInstanceId);",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/user/5",
					"host": ["{{baseUrl}}"],
					"path": ["api", "user", "5"]
				},
				"description": "L·∫•y user theo ID - Th√™m logs v√†o c√πng Logger instance"
			},
			"response": []
		},
		{
			"name": "4. Get All Products (ProductController)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"ProductController uses SAME Singleton Instance\", function () {",
							"    var jsonData = pm.response.json();",
							"    var savedInstanceId = pm.environment.get(\"loggerInstanceId\");",
							"    ",
							"    pm.expect(jsonData.loggerInstanceId).to.eql(savedInstanceId);",
							"    console.log(\"‚úÖ ProductController Instance ID:\", jsonData.loggerInstanceId);",
							"    console.log(\"üéØ SAME as UserController! Singleton works!\");",
							"});",
							"",
							"pm.test(\"Response has product data\", function () {",
							"    var jsonData = pm.response.json();",
							"    pm.expect(jsonData.success).to.be.true;",
							"    pm.expect(jsonData.data).to.be.an('array');",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/product",
					"host": ["{{baseUrl}}"],
					"path": ["api", "product"]
				},
				"description": "L·∫•y danh s√°ch products - ProductController c≈©ng d√πng C√ôNG Logger instance"
			},
			"response": []
		},
		{
			"name": "5. Search Products (ProductController)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"Still using SAME Singleton Instance\", function () {",
							"    var jsonData = pm.response.json();",
							"    var savedInstanceId = pm.environment.get(\"loggerInstanceId\");",
							"    pm.expect(jsonData.loggerInstanceId).to.eql(savedInstanceId);",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/product/search?keyword=laptop",
					"host": ["{{baseUrl}}"],
					"path": ["api", "product", "search"],
					"query": [
						{
							"key": "keyword",
							"value": "laptop"
						}
					]
				},
				"description": "T√¨m ki·∫øm s·∫£n ph·∫©m - Th√™m logs v√†o c√πng instance"
			},
			"response": []
		},
		{
			"name": "6. Create User (UserController)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 201\", function () {",
							"    pm.response.to.have.status(201);",
							"});",
							"",
							"pm.test(\"POST request also uses SAME Instance\", function () {",
							"    var jsonData = pm.response.json();",
							"    var savedInstanceId = pm.environment.get(\"loggerInstanceId\");",
							"    pm.expect(jsonData.loggerInstanceId).to.eql(savedInstanceId);",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/json"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"name\": \"Nguy·ªÖn VƒÉn Test\",\n  \"email\": \"test@example.com\"\n}"
				},
				"url": {
					"raw": "{{baseUrl}}/api/user",
					"host": ["{{baseUrl}}"],
					"path": ["api", "user"]
				},
				"description": "T·∫°o user m·ªõi - POST request c≈©ng d√πng C√ôNG Logger instance"
			},
			"response": []
		},
		{
			"name": "7. Get User with Invalid ID (Warning Log)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 400 (Bad Request)\", function () {",
							"    pm.response.to.have.status(400);",
							"});",
							"",
							"pm.test(\"Error also uses SAME Singleton Instance\", function () {",
							"    // Kh√¥ng c√≥ loggerInstanceId trong error response",
							"    console.log(\"‚ö†Ô∏è Request n√†y t·∫°o WARNING log trong Singleton Logger\");",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/user/-1",
					"host": ["{{baseUrl}}"],
					"path": ["api", "user", "-1"]
				},
				"description": "Request v·ªõi ID kh√¥ng h·ª£p l·ªá - T·∫°o WARNING log"
			},
			"response": []
		},
		{
			"name": "8. Get User Not Found (Error Log)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 404 (Not Found)\", function () {",
							"    pm.response.to.have.status(404);",
							"});",
							"",
							"pm.test(\"Error also logged in Singleton\", function () {",
							"    console.log(\"‚ùå Request n√†y t·∫°o ERROR log trong Singleton Logger\");",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/user/999",
					"host": ["{{baseUrl}}"],
					"path": ["api", "user", "999"]
				},
				"description": "Request user kh√¥ng t·ªìn t·∫°i - T·∫°o ERROR log"
			},
			"response": []
		},
		{
			"name": "9. VERIFY SINGLETON - Instance Check",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"üéØ SINGLETON VERIFIED - All instances are SAME\", function () {",
							"    var jsonData = pm.response.json();",
							"    var savedInstanceId = pm.environment.get(\"loggerInstanceId\");",
							"    ",
							"    pm.expect(jsonData.isSingleton).to.be.true;",
							"    pm.expect(jsonData.instance1Id).to.eql(jsonData.instance2Id);",
							"    pm.expect(jsonData.instance2Id).to.eql(jsonData.instance3Id);",
							"    pm.expect(jsonData.instance3Id).to.eql(jsonData.currentInstanceId);",
							"    pm.expect(jsonData.currentInstanceId).to.eql(savedInstanceId);",
							"    ",
							"    console.log(\"\\nüéâ ========================================\");",
							"    console.log(\"‚úÖ SINGLETON PATTERN WORKS PERFECTLY!\");",
							"    console.log(\"‚úÖ Instance 1 ID:\", jsonData.instance1Id);",
							"    console.log(\"‚úÖ Instance 2 ID:\", jsonData.instance2Id);",
							"    console.log(\"‚úÖ Instance 3 ID:\", jsonData.instance3Id);",
							"    console.log(\"‚úÖ Current ID:\", jsonData.currentInstanceId);",
							"    console.log(\"‚úÖ Saved ID:\", savedInstanceId);",
							"    console.log(\"üéØ All IDs are IDENTICAL!\");",
							"    console.log(\"========================================\\n\");",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/log/verify-singleton",
					"host": ["{{baseUrl}}"],
					"path": ["api", "log", "verify-singleton"]
				},
				"description": "üéØ KI·ªÇM TRA SINGLETON - X√°c nh·∫≠n t·∫•t c·∫£ instances ƒë·ªÅu gi·ªëng nhau"
			},
			"response": []
		},
		{
			"name": "10. Get ALL Logs (See Accumulated Logs)",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"üìä Logs accumulated from ALL Controllers\", function () {",
							"    var jsonData = pm.response.json();",
							"    var savedInstanceId = pm.environment.get(\"loggerInstanceId\");",
							"    ",
							"    pm.expect(jsonData.success).to.be.true;",
							"    pm.expect(jsonData.loggerInstanceId).to.eql(savedInstanceId);",
							"    pm.expect(jsonData.totalLogs).to.be.above(0);",
							"    ",
							"    console.log(\"\\nüìä ========================================\");",
							"    console.log(\"üìù TOTAL LOGS ACCUMULATED:\", jsonData.totalLogs);",
							"    console.log(\"‚úÖ Logger Instance ID:\", jsonData.loggerInstanceId);",
							"    console.log(\"\\nüìã Log entries from different controllers:\");",
							"    ",
							"    var userControllerLogs = 0;",
							"    var productControllerLogs = 0;",
							"    var logControllerLogs = 0;",
							"    var otherLogs = 0;",
							"    ",
							"    jsonData.data.forEach(function(log) {",
							"        if (log.source.includes('UserController')) {",
							"            userControllerLogs++;",
							"        } else if (log.source.includes('ProductController')) {",
							"            productControllerLogs++;",
							"        } else if (log.source.includes('LogController')) {",
							"            logControllerLogs++;",
							"        } else {",
							"            otherLogs++;",
							"        }",
							"    });",
							"    ",
							"    console.log(\"   üë§ UserController logs:\", userControllerLogs);",
							"    console.log(\"   üì¶ ProductController logs:\", productControllerLogs);",
							"    console.log(\"   üìä LogController logs:\", logControllerLogs);",
							"    console.log(\"   üîß Other logs (Program, etc):\", otherLogs);",
							"    console.log(\"\\nüéØ All logs from different controllers are in\");",
							"    console.log(\"   the SAME Singleton Logger instance!\");",
							"    console.log(\"========================================\\n\");",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/log",
					"host": ["{{baseUrl}}"],
					"path": ["api", "log"]
				},
				"description": "üìä XEM T·∫§T C·∫¢ LOGS - Logs t·ª´ UserController, ProductController, LogController ƒë·ªÅu t√≠ch l≈©y trong c√πng m·ªôt Singleton instance"
			},
			"response": []
		},
		{
			"name": "11. Get Log Statistics",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"üìà Statistics from Singleton Logger\", function () {",
							"    var jsonData = pm.response.json();",
							"    var savedInstanceId = pm.environment.get(\"loggerInstanceId\");",
							"    ",
							"    pm.expect(jsonData.success).to.be.true;",
							"    pm.expect(jsonData.data.loggerInstanceId).to.eql(savedInstanceId);",
							"    ",
							"    console.log(\"\\nüìà ========================================\");",
							"    console.log(\"üìä LOG STATISTICS:\");",
							"    console.log(\"   Total Logs:\", jsonData.data.totalLogs);",
							"    console.log(\"   ‚úÖ INFO Logs:\", jsonData.data.infoLogs);",
							"    console.log(\"   ‚ö†Ô∏è  WARNING Logs:\", jsonData.data.warningLogs);",
							"    console.log(\"   ‚ùå ERROR Logs:\", jsonData.data.errorLogs);",
							"    console.log(\"   üîë Logger Instance:\", jsonData.data.loggerInstanceId);",
							"    console.log(\"========================================\\n\");",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/log/stats",
					"host": ["{{baseUrl}}"],
					"path": ["api", "log", "stats"]
				},
				"description": "üìà Xem th·ªëng k√™ logs - INFO, WARNING, ERROR t·ª´ c√πng Singleton instance"
			},
			"response": []
		},
		{
			"name": "12. Get INFO Logs Only",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"All logs are INFO level\", function () {",
							"    var jsonData = pm.response.json();",
							"    jsonData.data.forEach(function(log) {",
							"        pm.expect(log.level).to.eql('INFO');",
							"    });",
							"    console.log(\"‚úÖ Total INFO logs:\", jsonData.totalLogs);",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/log/level/INFO",
					"host": ["{{baseUrl}}"],
					"path": ["api", "log", "level", "INFO"]
				},
				"description": "L·ªçc ch·ªâ xem INFO logs t·ª´ Singleton instance"
			},
			"response": []
		},
		{
			"name": "13. Get WARNING Logs Only",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"All logs are WARNING level\", function () {",
							"    var jsonData = pm.response.json();",
							"    jsonData.data.forEach(function(log) {",
							"        pm.expect(log.level).to.eql('WARNING');",
							"    });",
							"    console.log(\"‚ö†Ô∏è Total WARNING logs:\", jsonData.totalLogs);",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/log/level/WARNING",
					"host": ["{{baseUrl}}"],
					"path": ["api", "log", "level", "WARNING"]
				},
				"description": "L·ªçc ch·ªâ xem WARNING logs"
			},
			"response": []
		},
		{
			"name": "14. Get ERROR Logs Only",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Status code is 200\", function () {",
							"    pm.response.to.have.status(200);",
							"});",
							"",
							"pm.test(\"All logs are ERROR level\", function () {",
							"    var jsonData = pm.response.json();",
							"    jsonData.data.forEach(function(log) {",
							"        pm.expect(log.level).to.eql('ERROR');",
							"    });",
							"    console.log(\"‚ùå Total ERROR logs:\", jsonData.totalLogs);",
							"});"
						],
						"type": "text/javascript"
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{baseUrl}}/api/log/level/ERROR",
					"host": ["{{baseUrl}}"],
					"path": ["api", "log", "level", "ERROR"]
				},
				"description": "L·ªçc ch·ªâ xem ERROR logs"
			},
			"response": []
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:5000",
			"type": "string"
		}
	]
}
